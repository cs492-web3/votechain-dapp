(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6964],{13379:function(t,e,n){"use strict";var r=n(64836);e.Z=void 0;var a=r(n(64938)),i=n(85893);e.Z=(0,a.default)((0,i.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos")},47077:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return n(81576)}])},1358:function(t,e,n){"use strict";n.d(e,{Z:function(){return h}});var r=n(85893),a=n(69417),i=n(50657),o=n(31425),s=n(6514),c=n(58951),l=n(37645),u=n(90948);let d=(0,u.ZP)("div")(()=>({marginTop:5})),p=(0,u.ZP)("div")(()=>({marginTop:15,marginBottom:15,fontSize:"18px",color:"#0288d1"})),m=(0,u.ZP)(a.Z)(()=>({marginTop:30,fontSize:"15px",color:"#0288d1",border:"1px solid #0288d1"})),f=t=>{let{NFTCA:e,tokenId:n}=t,a="https://pixxiti.com/ethereum/goerli/nfts/"+e+"/"+n;return(0,r.jsxs)("div",{style:{marginTop:"10px"},children:[(0,r.jsx)(p,{children:"You got NFT as Reward! \uD83C\uDF07"}),(0,r.jsx)(d,{children:"Your NFT contract Address is ".concat(e," ")}),(0,r.jsx)(d,{children:"Your Token ID is ".concat(n)}),(0,r.jsx)(m,{onClick:()=>window.open(a,"_blank"),children:"Check Your NFT"})]})};function h(t){let{open:e,result:n,handleClose:u,onClickClose:d,NFTCA:p,tokenId:m}=t;return(0,r.jsx)("div",{children:(0,r.jsxs)(i.Z,{open:e,onClose:u,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:"xl",fullWidth:!0,children:[(0,r.jsx)(l.Z,{id:"alert-dialog-title",children:"Transaction Result"}),(0,r.jsxs)(s.Z,{children:[0!=Object.entries(n).length?(0,r.jsxs)(c.Z,{id:"alert-dialog-description",children:[(0,r.jsx)("div",{children:"Transaction Result : ".concat(n.status)}),(0,r.jsx)("div",{children:n.message})]}):(0,r.jsx)(c.Z,{id:"alert-dialog-description",children:"Transaction ongoing"}),"success"==n.status&&p&&m&&(0,r.jsx)(f,{NFTCA:p,tokenId:m})]}),(0,r.jsx)(o.Z,{children:(0,r.jsx)(a.Z,{onClick:d,children:"CLOSE"})})]})})}},81576:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return $}});var r=n(85893),a=n(67294),i=n(7297),o=n(90948),s=n(15861),c=n(69417);function l(){let t=(0,i.Z)(["\n  variant: h1;\n  align: center;\n  color: white;\n  font-size: 25px;\n  margin: 40px;\n"]);return l=function(){return t},t}function u(){let t=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  min-height: 50vh;\n"]);return u=function(){return t},t}function d(){let t=(0,i.Z)(["\n  border: 1px solid #42a5f5;\n  background-color: rgba(25, 118, 210, 0.5);\n  border-radius: 30px;\n  padding: 15px;\n  color: white;\n"]);return d=function(){return t},t}let p=(0,o.ZP)(s.Z)(l()),m=(0,o.ZP)("div")(u());(0,o.ZP)(c.Z)(d());var f=n(11163),h=n(4480),y=n(46101),g=n(62140),w=n(60226),x=n(1358),b=n(90629);function C(){let t=(0,i.Z)(["\n  variant: h1;\n  color: white;\n  font-size: 25px;\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 10px;\n"]);return C=function(){return t},t}function j(){let t=(0,i.Z)(["\n  color: white;\n  font-size: 15px;\n  margin-top: 5px;\n  margin-bottom: 5px;\n"]);return j=function(){return t},t}function T(){let t=(0,i.Z)(["\n  color: black;\n  font-size: 15px;\n"]);return T=function(){return t},t}function Z(){let t=(0,i.Z)(["\n  border: 1px solid grey;\n  padding: 10px;\n  border-radius: 10px;\n  margin-top: 10px;\n  margin-bottom: 10px;\n"]);return Z=function(){return t},t}function v(){let t=(0,i.Z)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  margin-top: 10px;\n  margin-bottom: 10px;\n"]);return v=function(){return t},t}function A(){let t=(0,i.Z)(["\n  border: 1px solid #1976d2;\n  margin-top: 20px;\n"]);return A=function(){return t},t}function N(){let t=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: left;\n  padding: 30px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 10px;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  width: 80%;\n"]);return N=function(){return t},t}function k(){let t=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: left;\n  padding: 10px;\n  margin-top: 10px;\n"]);return k=function(){return t},t}let D=(0,o.ZP)("div")(C()),S=(0,o.ZP)(s.Z)(j()),I=(0,o.ZP)(s.Z)(T()),E=(0,o.ZP)("div")(t=>({borderWidth:1,borderRadius:20,borderColor:t.disabled?"grey":"#1976d2",color:t.disabled?"grey":"#1976d2"})),P=(0,o.ZP)("div")(Z()),F=(0,o.ZP)("div")(v()),B=(0,o.ZP)(c.Z)(A()),M=(0,o.ZP)("div")(N()),R=(0,o.ZP)(b.Z)(k());var _=n(13379);let V=t=>{let{contractAddress:e,name:n,ABI:i}=t,o=(0,f.useRouter)(),[s,c]=(0,a.useState)(0),[l,u]=(0,a.useState)([]),[d,p]=(0,a.useState)(0),[m,h]=(0,a.useState)(0),[y,w]=(0,a.useState)(""),[b,C]=(0,a.useState)({}),[j,T]=(0,a.useState)(!1),Z=()=>{0!=Object.entries(C).length&&(T(!1),o.reload())},v=()=>{T(!1),o.reload()};(0,a.useEffect)(()=>{async function t(){let t=await (0,g.yr)(i,e);isNaN(t)||c(Number(t))}async function n(){let t=await (0,g.Zq)(i,e);isNaN(t)||h(Number(t))}async function r(){let t=await (0,g.Eb)(i,e);w(t)}(async function(){let t=await (0,g.M3)(i,e);isNaN(t)||p(Number(t))})(),t(),n(),r()},[]),(0,a.useEffect)(()=>{async function t(t){let n=await (0,g.o5)(i,e,t);var r="-";2==s&&(r=await (0,g.BF)(i,e,t)),u(t=>[...t,{name:n,voteCount:r}])}for(let n=0;n<d;n++)u([]),t(n)},[d]);let A=async()=>{if(T(!0),0==s){let t=await (0,g.sj)(i,e);C(t)}else if(1==s){let n=await (0,g.Tx)(i,e);C(n)}},N=async()=>{T(!0);let t=await (0,g.hh)(i,e);C(t)};return(0,r.jsxs)(M,{children:[(0,r.jsxs)(D,{children:[(0,r.jsx)("div",{style:{color:"#b2ddef",marginRight:10},children:y})," ","투표 정보"]}),(0,r.jsxs)(P,{children:[(0,r.jsx)(S,{children:"현재 투표 status"}),(0,r.jsxs)(F,{children:[(0,r.jsx)(E,{disabled:0!=s,children:"후보자 등록 진행중"}),(0,r.jsx)(_.Z,{sx:{color:"grey"}}),(0,r.jsx)(E,{disabled:1!=s,children:"Vote 시작"}),(0,r.jsx)(_.Z,{sx:{color:"grey"}}),(0,r.jsx)(E,{disabled:2!=s,children:"Vote 완료"})]})]}),(0,r.jsxs)(S,{children:["현재 등록된 후보자 수: ",d]}),(0,r.jsxs)(S,{children:["현재까지 총 투표 수: ",m]}),(0,r.jsx)(S,{children:"현재 등록된 후보자 정보"}),l.map((t,e)=>(0,r.jsxs)(R,{children:[(0,r.jsxs)(I,{children:["후보자 이름 : ",t.name]}),(0,r.jsxs)(I,{children:["현재 득표수 : ",t.voteCount]})]},e)),2!=s&&(0,r.jsx)(B,{onClick:A,children:"다음 투표 과정으로 넘어가기"}),2==s&&(0,r.jsx)(B,{onClick:N,children:"투표 다시 재개하기"}),(0,r.jsx)(x.Z,{open:j,result:b,handleClose:Z,onClickClose:v})]})};function $(){let t=(0,f.useRouter)(),[e,n]=(0,a.useState)([]),[i,o]=(0,a.useState)([]);(0,h.useRecoilValue)(y.c);let[s,c]=(0,a.useState)(!1),[l,u]=(0,a.useState)({});(0,a.useEffect)(()=>{(async function(){var t=await (0,w.nD)();o(t=t.filter(t=>!t.isDeleted))})()},[]),(0,a.useEffect)(()=>{async function t(t){if(""!=t.contractAddress){let e=await (0,g.kh)(t.contractAddress),r=await (0,g.TT)(e,t.contractAddress),a={name:t.name,contractAddress:t.contractAddress,ABI:e};r&&n(t=>[...t,a])}}n([]),i.map(e=>{t(e)})},[i]);let d=()=>{0!=Object.entries(u).length&&(c(!1),t.reload())},b=()=>{c(!1),t.reload()};return(0,r.jsxs)(m,{children:[0!=e.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p,{children:"관리자 페이지에 오신 것을 환영합니다"}),e.map((t,e)=>(0,r.jsx)(V,{contractAddress:t.contractAddress,name:t.name,ABI:t.ABI},e))]}):(0,r.jsx)(p,{children:"관리자가 아닙니다"}),(0,r.jsx)(x.Z,{open:s,result:l,handleClose:d,onClickClose:b})]})}},60226:function(t,e,n){"use strict";n.d(e,{Jy:function(){return l},qq:function(){return d},nD:function(){return u},TT:function(){return c},V3:function(){return p}});var r=n(68959),a=JSON.parse('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"addressString","type":"string"}],"name":"addContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"admin","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"contractInfos","outputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"contractAddress","type":"string"},{"internalType":"bool","name":"isDeleted","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"contracts","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"deleteContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getAllContracts","outputs":[{"components":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"contractAddress","type":"string"},{"internalType":"bool","name":"isDeleted","type":"bool"}],"internalType":"struct admin_contract.ContractInfo[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"addr","type":"address"}],"name":"getIsAdmin","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"reopenContract","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"totalContractNum","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]');let i=(0,r.gL)("wss://eth-goerli.g.alchemy.com/v2/tzC7BEXGGRYsQDD6Qw8XkCYRNx3Ve4EL"),o="0x12D1FC33d8aa9b1E4bb1F2e8e2E97EC7efb28F94",s=new i.eth.Contract(a,o),c=async t=>{let e=await s.methods.getIsAdmin(t).call();return e},l=async(t,e,n)=>{let r=s.methods.addContract(e,n).encodeABI(),a=await m(t,r);return a},u=async()=>{let t=await s.methods.getAllContracts().call();return t},d=async(t,e)=>{let n=s.methods.deleteContract(e).encodeABI(),r=await m(t,n);return r},p=async(t,e)=>{let n=s.methods.reopenContract(e).encodeABI(),r=await m(t,n);return r};async function m(t,e){if(""==t)return{status:"fail",message:"\uD83D\uDCA1 Connect your Metamask wallet to vote on the blockchain."};try{let n=await window.ethereum.request({method:"eth_sendTransaction",params:[{to:o,from:t,data:e}]});return{status:"success",message:n}}catch(r){return{status:"fail",message:"\uD83D\uDE25 "+r.message}}}},62140:function(t,e,n){"use strict";n.d(e,{A5:function(){return h},BF:function(){return y},Eb:function(){return A},M3:function(){return m},TT:function(){return w},Tx:function(){return l},Uu:function(){return b},Zq:function(){return g},eX:function(){return v},hg:function(){return T},hh:function(){return u},je:function(){return j},kh:function(){return s},lL:function(){return x},o5:function(){return f},s4:function(){return d},sj:function(){return c},w4:function(){return Z},wD:function(){return p},yr:function(){return C}});var r=n(68959),a=n(46101),i=n(43584);let o=(0,r.gL)("wss://eth-goerli.g.alchemy.com/v2/tzC7BEXGGRYsQDD6Qw8XkCYRNx3Ve4EL");async function s(t){let e=new URLSearchParams({module:"contract",action:"getabi",address:t,apikey:"34MSPWMQ2JYQ695W8F4B9KVYPF6KF2XVR5"}).toString(),n="".concat("https://api-goerli.etherscan.io/api","?").concat(e),r=await fetch(n),a=await r.json();if("1"==a.status){let i=JSON.parse(a.result);return i}}let c=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=r.methods.startVoteSession().encodeABI(),c=await N(n,s,e);return c},l=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=r.methods.endVoteSession().encodeABI(),c=await N(n,s,e);return c},u=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=r.methods.restartVoteSession().encodeABI(),c=await N(n,s,e);return c},d=async(t,e,n)=>{let r=(0,i.$l)(a.c),s=new o.eth.Contract(t,e),c=s.methods.voteAndGetNFT(n).encodeABI(),l=await N(r,c,e);return l},p=async(t,e,n)=>{let r=(0,i.$l)(a.c),s=new o.eth.Contract(t,e),c=s.methods.registerCandidateAndGetNFT(n).encodeABI(),l=await N(r,c,e);return l},m=async(t,e)=>{let n=new o.eth.Contract(t,e),r=await n.methods.getTotalCandidateNum().call();return r},f=async(t,e,n)=>{let r=(0,i.$l)(a.c),s=new o.eth.Contract(t,e),c=await s.methods.getCandidateName(n).call({from:r});return c},h=async(t,e)=>{let n=new o.eth.Contract(t,e),r=await n.methods.getAllCandidateNames().call();return r},y=async(t,e,n)=>{let r=(0,i.$l)(a.c),s=new o.eth.Contract(t,e),c=await s.methods.getCandidateVoteCount(n).call({from:r});return c},g=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=await r.methods.getTotalVoteCount().call({from:n});return s},w=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=await r.methods.getIsAdmin(n).call();return s},x=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=await r.methods.getRecentTokenId(n).call();return console.log(s),s},b=async(t,e)=>{let n=new o.eth.Contract(t,e),r=await n.methods.getNFTTokenCA().call();return r},C=async(t,e)=>{let n=new o.eth.Contract(t,e),r=await n.methods.getElectionStatus().call();return r},j=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=await r.methods.getHasVoted(n).call();return s},T=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=await r.methods.getRegisterNum(n).call();return s},Z=async(t,e)=>{let n=(0,i.$l)(a.c),r=new o.eth.Contract(t,e),s=await r.methods.getTokenIds(n).call();return s},v=async(t,e)=>{let n=new o.eth.Contract(t,e),r=await n.methods.getIsShowResultImm().call();return r},A=async(t,e)=>{(0,i.$l)(a.c);let n=new o.eth.Contract(t,e),r=await n.methods.getDescription().call();return r};async function N(t,e,n){if(""==t)return{status:"fail",message:"\uD83D\uDCA1 Connect your Metamask wallet to vote on the blockchain."};try{let r=await window.ethereum.request({method:"eth_sendTransaction",params:[{to:n,from:t,data:e}]});return{status:"success",message:r}}catch(a){return{status:"fail",message:"\uD83D\uDE25 "+a.message}}}},46101:function(t,e,n){"use strict";n.d(e,{c:function(){return a}});var r=n(4480);let a=(0,r.atom)({key:"walletAddress",default:""})},46601:function(){}},function(t){t.O(0,[8543,8959,5378,9774,2888,179],function(){return t(t.s=47077)}),_N_E=t.O()}]);